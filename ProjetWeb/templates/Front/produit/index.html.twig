{% extends 'baseFront.html.twig' %}

{% block body %}
<body>

  <div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>

    <div class="hero overlay" style="background-image: url('assets/images/background.jpg');">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-lg-5 mx-auto text-center">
            <h1 class="text-white">Produits</h1>
            <p>Vos produits sont disponibles ici</p>
          </div>
        </div>
      </div>
    </div>

    <div class="container site-section">
      <div class="row">
        <div class="col-6 title-section">
          <h2 class="heading">Latest Products</h2>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12"> <!-- Expand the search input to take the entire width -->
          <div class="search-container"> <!-- New container for search input -->
            <input type="text" id="searchInput" class="search-input" placeholder="Search..."> <!-- Apply search-input class -->
          </div>
          <div id="searchResults"></div>
        </div>
      </div>

      <div class="row existing-products">
        {% for produit in p %}
        <div class="col-lg-4 mb-4">
          <div class="custom-media d-block">
            <div class="img mb-4">
              {% if produit.getImageProd() %}
              <a href="single.html">
                <img src="{{ asset('assets/' ~ produit.getImageProd()) }}" alt="Image du produit" class="img-fluid">
              </a>
              {% else %}
              No Image
              {% endif %}
            </div>
            <div class="text">
              <span class="meta">{{ produit.prix_prod }}</span>
              <h3 class="mb-4"><a href="#">{{ produit.nomProd }}</a></h3>
              <p style="color: #fff;">{{ produit.description_prod }}</p>
              <p><a href="#" style="color: #008152;">{{ produit.getCategorie().getNomCategorie() }}</a></p>
              <a href="{{ path('ajouterPanier', {'idProduit': produit.id}) }}" class="btn py-3 px-4 mr-3 btn-primary">
                Ajouter au panier
              </a>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

    </div>

    <div class="row justify-content-center">
      <div class="col-lg-7 text-center">
        <div class="custom-pagination">
          <a href="#" style="color: #008152;">1</a>
          <span style="color: #008152;">2</span>
          <a href="#" style="color: #008152;">3</a>
          <a href="#" style="color: #008152;">4</a>
          <a href="#" style="color: #008152;">5</a>
        </div>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#searchInput').on('input', function() {
        var query = $(this).val().trim();
        if (query.length > 0) {
          $.ajax({
            url: "{{ path('search_produit') }}",
            method: "POST",
            data: { query: query },
            success: function(response) {
              // Hide existing products section
              $('.existing-products').hide();
              $('#searchResults').html(response).show(); // Display search results
            }
          });
        } else {
          // Show existing products section when search input is empty
          $('.existing-products').show();
          $('#searchResults').empty().hide(); // Hide search results container
        }
      });
    });
  </script>

  <style>
    /* Add this CSS to your stylesheet */
    .search-container {
      position: relative;
    }

    .search-input {
      width: 100%; /* Set the search input width to 100% */
      padding: 10px 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      transition: border-color 0.4s ease;
      margin-bottom: 15px;
      background-color: transparent;
      color:white;
    }

    .search-input:focus {
      outline: none;
      border-color: #008152;
    }
  </style>
</body>
{% endblock %}
